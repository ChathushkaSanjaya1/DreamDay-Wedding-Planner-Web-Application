@{
    ViewData["Title"] = "My Checklist";
}

@section Styles {
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            background-color: #f5f7fa;
        }

        .sidebar {
            background: linear-gradient(180deg, #3F51B5 0%, #5C6BC0 100%);
            color: #fff;
            min-height: 100vh;
        }

            .sidebar .nav-link {
                color: #e0e0e0;
                font-weight: 500;
            }

                .sidebar .nav-link:hover {
                    background-color: rgba(255, 255, 255, 0.1);
                }

                .sidebar .nav-link.active {
                    background-color: #fff;
                    color: #3F51B5 !important;
                    font-weight: bold;
                    border-radius: 8px;
                }

        .card {
            border-left: 5px solid #3F51B5;
            border-radius: 12px;
        }

        .checklist-item input[type="checkbox"] {
            accent-color: #3F51B5;
            transform: scale(1.2);
            margin-right: 10px;
        }

        .checklist-item.completed label {
            text-decoration: line-through;
            color: #999;
        }

        .form-check-label {
            font-size: 1rem;
        }

        .add-task-input {
            border-radius: 8px;
            padding: 8px 12px;
            border: 1px solid #ccc;
        }

        .btn-add-task {
            margin-top: 10px;
            background-color: #3F51B5;
            border: none;
            color: white;
            padding: 6px 16px;
            border-radius: 6px;
        }

            .btn-add-task:hover {
                background-color: #303F9F;
            }
    </style>
}

<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <nav class="col-12 col-md-3 col-lg-2 sidebar p-4">
            <h4 class="fw-bold text-white mb-4"><i class="fas fa-gem me-2"></i>DreamDay</h4>
            <ul class="nav flex-column">
                <li class="nav-item"><a class="nav-link" asp-controller="Home" asp-action="Dashboard"><i class="fas fa-home me-2"></i>Dashboard</a></li>
                <li class="nav-item"><a class="nav-link active" asp-controller="Home" asp-action="Checklist"><i class="fas fa-check-circle me-2"></i>Checklist</a></li>
                <li class="nav-item"><a class="nav-link" asp-controller="Home" asp-action="Budget"><i class="fas fa-wallet me-2"></i>Budget</a></li>
                <li class="nav-item"><a class="nav-link" asp-controller="Home" asp-action="Guests"><i class="fas fa-users me-2"></i>Guests</a></li>
                <li class="nav-item"><a class="nav-link" asp-controller="Home" asp-action="Dahboard_Vendors"><i class="fas fa-store me-2"></i>Vendors</a></li>
                <li class="nav-item"><a class="nav-link" asp-controller="Home" asp-action="Timeline"><i class="fas fa-calendar-alt me-2"></i>Timeline</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="col-12 col-md-9 col-lg-10 px-4 py-5">
            <h2 class="fw-bold text-primary mb-4"><i class="fas fa-check-circle me-2"></i>Customizable Wedding Checklist</h2>

            <div class="card p-4 shadow-sm mb-4">
                <div class="row g-3 checklist-list" id="checklist-container">
                    <!-- Tasks will be injected by JavaScript -->
                </div>

                <div class="mt-4">
                    <input type="text" id="new-task" class="form-control add-task-input" placeholder="Add new task..." />
                    <button class="btn btn-add-task mt-2" onclick="addTask()"><i class="fas fa-plus me-1"></i>Add Task</button>
                </div>
            </div>
        </main>
    </div>
</div>

@section Scripts {
    <script>
        const defaultTasks = [
            "Finalize wedding date and budget",
            "Book venue and ceremony location",
            "Select caterer and plan menu",
            "Design invitations and send to guests",
            "Book photographer and videographer",
            "Schedule hair and makeup trials",
            "Choose DJ or band and finalize playlist",
            "Prepare wedding day timeline"
        ];

        const container = document.getElementById("checklist-container");

        // Load tasks from localStorage
        let checklist = JSON.parse(localStorage.getItem("weddingChecklist")) || defaultTasks.map(t => ({ text: t, checked: false }));

        function renderChecklist() {
            container.innerHTML = "";
            checklist.forEach((task, index) => {
                const checkedClass = task.checked ? "completed" : "";
                const checkedAttr = task.checked ? "checked" : "";

                container.innerHTML += `
                    <div class="col-md-6 checklist-item ${checkedClass}">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="task${index}" ${checkedAttr} onchange="toggleTask(${index})">
                            <label class="form-check-label" for="task${index}">${task.text}</label>
                        </div>
                    </div>`;
            });
        }

        function toggleTask(index) {
            checklist[index].checked = !checklist[index].checked;
            saveChecklist();
            renderChecklist();
        }

        function addTask() {
            const input = document.getElementById("new-task");
            const taskText = input.value.trim();
            if (taskText.length > 0) {
                checklist.push({ text: taskText, checked: false });
                input.value = "";
                saveChecklist();
                renderChecklist();
            }
        }

        function saveChecklist() {
            localStorage.setItem("weddingChecklist", JSON.stringify(checklist));
        }

        // Initialize
        renderChecklist();
    </script>
}
